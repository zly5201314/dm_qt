require(["/pc/js/require/config.js?v=1"],function(){require(["cookie","commonTips","pagination","commonLazy"],function(t,e,c,i){function a(){c(o),i.dynamicLazyimg.update();var t="",a=$("input[name='item-product']"),n=$("span#delete_items"),r=$("div.pro-info").find("input[name='item-product'][data-status='1']"),d=$("input#checkAll,input#checkout-checkAll"),l=0;r.attr("checked","true"),d.attr("checked","true"),r.each(function(e,c){var i=$(c);l+=i.data("price"),""==t?t=i.data("id"):t+=","+i.data("id")}),$("i.severalProduct").text(r.length),$("i.allItemsPrice").text(l.toFixed(2)),$("div.pro-info").find("input[name='item-product'][data-status='0']").attr("disabled","disabled"),a.on("change",function(){l=0;var e=0;t="",r.each(function(c,i){var a=$(i);a.is(":checked")&&(e++,l+=a.data("price"),""==t?t=a.data("id"):t+=","+a.data("id")),$("i.severalProduct").text(e),$("i.allItemsPrice").text(l.toFixed(2)),e==r.length?d.attr("checked","true"):d.removeAttr("checked")})}),d.on("change",function(){$(this).is(":checked")?(r.attr("checked","true"),d.attr("checked","true"),l=0,t="",r.each(function(e,c){var i=$(c);l+=i.data("price"),$("i.severalProduct").text(r.length),$("i.allItemsPrice").text(l.toFixed(2)),""==t?t=i.data("id"):t+=","+i.data("id")})):(r.removeAttr("checked"),d.removeAttr("checked"),$("i.severalProduct").text(0),$("i.allItemsPrice").text(0),t="")}),n.on("click",function(){var t=$(this);$.ajax({type:"POST",url:cartUrl,data:{ids:t.data("id"),option:"del"},success:function(c){if($("html,body").animate({scrollTop:"120px"},500),3==c.code){t.parents(".pro-info").fadeOut().remove(),e.Walert({flagicon:"icon-duihao1",color:"#45cd8f",closeBtn:!1,contentHtml:c.info});var i=0;a=$("input[name='item-product']"),r=$("div.pro-info").find("input[name='item-product']"),d=$("input#checkAll,input#checkout-checkAll"),$("i.severalProduct").text($("input[name='item-product']:checked").length),r.each(function(t,e){var c=$(e),a=0;c.is(":checked")&&(i+=c.data("price"),a++),a==r.length?d.attr("checked","true"):d.removeAttr("checked")}),$("#cart-num").text($.cookie("cart_number")),$("i.allItemsPrice").text(i.toFixed(2)),$("a.all").children("em").text(c.data.all),$("a.active").children("em").text(c.data.active),$("a.no_active").children("em").text(c.data.no_active),0==r.length&&location.reload()}else e.Walert({closeBtn:!1,contentHtml:c.info})}})}),$("span.goPay").on("click",function(){r.is(":checked")?(e.loadShow.init(),$.get(checkoutOrder+"&id="+t,function(c){if(e.loadShow.close(),18==c.code)e.Galert({flagicon:"icon-wenhao",iconColor:"#e42c3d",needIcon:!0,contentHtml:["您结算的商品有未支付订单，是否重新下单？"],diyBtns:["前往支付","继续下单"],diyUrl:["/order/index.html?status=1",checkOutUrl+"?id="+t],color:["#f2a133","#5191d0"],tailContent:[""],closeBtn:!0,close:function(){$(".dm-g-fixedmask").hide().remove()}});else{var i=checkOutUrl+"?id="+t;location.href=i}})):e.Walert({closeBtn:!1,contentHtml:"请先选择需要结算产品"})})}$(window).scroll(function(t){!function(){var t=$(window).height(),e=$("#cart-list").offset().top,c=$(document).scrollTop();t-e-$("#cart-list").height()+c<130?$(".checkout").addClass("fixedBottom"):$(".checkout").removeClass("fixedBottom")}()});var o={postUrl:$ajaxUrl,getParams:{option:"view",status:$status},pageBelong:"list",page:1,parentEle:"#cart-list",callbackfunc:a};e.listloadShow.init({wrapcon:"#cart-list"}),$.when($.get($ajaxUrl,{option:"view",status:$status},function(t){$("#cart-list").html(t)})).done(function(){a()})})});